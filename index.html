<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>สุขสันต์วันเกิด jihexpeddopepop!</title>
    <style>
        /* * This CSS was updated to a pastel pink theme.
         * I've organized it and added comments to explain each part.
         */

        /* General styles to position the content */
        body {
            background-color: #fdf2f6; /* Very light pastel pink background */
            display: flex;
            align-items: flex-start; /* Changed to move content to the top */
            justify-content: center;
            height: 100vh;
            padding-top: 5vh; /* Added padding to create space from the top edge */
            margin: 0;
            overflow: hidden;
            font-family: 'Kanit', sans-serif;
            color: #5e3c5a; /* Darker pastel purple for text */
        }

        /* Fireworks Canvas */
        #fireworks-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }
        
        /* Heart Container */
        .heart-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }

        .heart {
            position: absolute;
            top: -50px;
            font-size: 20px;
            color: #ff7999;
            animation: fall-heart linear infinite;
        }

        @keyframes fall-heart {
            to {
                transform: translateY(105vh) rotate(360deg);
            }
        }

        .heart:nth-child(1) { left: 10%; animation-duration: 13s; animation-delay: 0s; }
        .heart:nth-child(2) { left: 20%; animation-duration: 10s; animation-delay: 2s; font-size: 15px; }
        .heart:nth-child(3) { left: 30%; animation-duration: 16s; animation-delay: 1s; }
        .heart:nth-child(4) { left: 40%; animation-duration: 12s; animation-delay: 4s; font-size: 18px; }
        .heart:nth-child(5) { left: 50%; animation-duration: 14s; animation-delay: 3s; }
        .heart:nth-child(6) { left: 60%; animation-duration: 11s; animation-delay: 5s; font-size: 16px; }
        .heart:nth-child(7) { left: 70%; animation-duration: 15s; animation-delay: 6s; }
        .heart:nth-child(8) { left: 80%; animation-duration: 9s;  animation-delay: 7s; font-size: 20px; }
        .heart:nth-child(9) { left: 90%; animation-duration: 17s; animation-delay: 8s; }
        .heart:nth-child(10) { left: 5%; animation-duration: 14s; animation-delay: 9s; font-size: 17px; }


        /* Balloon Container */
        .balloon-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* Place balloons behind hearts */
            overflow: hidden;
        }

        .balloon {
            position: absolute;
            bottom: -200px; /* Start from below the screen */
            width: 120px;
            height: 145px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            background-color: rgba(255, 192, 203, 0.8); /* Default pastel pink */
            animation: floatUp 20s linear infinite;
        }

        .balloon::after {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 25px;
            /* Added a colorful gradient to the balloon string */
            background: linear-gradient(to bottom, #ffc2e2, #e0d3e5, #fec8d8);
        }

        .balloon img {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
        }

        @keyframes floatUp {
            from {
                bottom: -200px;
                transform: translateX(0);
            }
            to {
                bottom: 100vh;
                transform: translateX(50px) rotate(15deg);
            }
        }

        /* Individual balloon styling for variety */
        .balloon:nth-child(1) { left: 10%; animation-duration: 25s; animation-delay: 0s; background-color: rgba(255, 192, 203, 0.8); }
        .balloon:nth-child(2) { left: 20%; animation-duration: 22s; animation-delay: 2s; background-color: rgba(173, 216, 230, 0.8); }
        .balloon:nth-child(3) { left: 30%; animation-duration: 28s; animation-delay: 5s; background-color: rgba(255, 248, 173, 0.8); }
        .balloon:nth-child(4) { left: 40%; animation-duration: 20s; animation-delay: 7s; background-color: rgba(191, 239, 191, 0.8); }
        .balloon:nth-child(5) { left: 50%; animation-duration: 26s; animation-delay: 10s; background-color: rgba(221, 160, 221, 0.8); }
        .balloon:nth-child(6) { left: 60%; animation-duration: 23s; animation-delay: 12s; background-color: rgba(255, 182, 193, 0.8); }
        .balloon:nth-child(7) { left: 70%; animation-duration: 27s; animation-delay: 15s; background-color: rgba(175, 238, 238, 0.8); }
        .balloon:nth-child(8) { left: 80%; animation-duration: 21s; animation-delay: 17s; background-color: rgba(240, 230, 140, 0.8); }
        .balloon:nth-child(9) { left: 5%;  animation-duration: 24s; animation-delay: 19s; background-color: rgba(255, 160, 122, 0.8); }
        .balloon:nth-child(10) { left: 85%; animation-duration: 29s; animation-delay: 21s; background-color: rgba(152, 251, 152, 0.8); }
        .balloon:nth-child(11) { left: 15%; animation-duration: 20s; animation-delay: 23s; background-color: rgba(216, 191, 216, 0.8); }


        /* Styles for the start screen overlay */
        #start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: transparent; /* Make it transparent to see animations */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
        }

        #start-screen h1 {
            font-size: 3rem;
            color: #a06d8a; /* Muted pastel purple text */
            text-shadow: 0 0 10px #ffc2e2;
            margin-bottom: 20px;
        }

        #start-button {
            padding: 15px 30px;
            font-size: 1.5rem;
            color: #5e3c5a; /* Darker text for contrast */
            background-color: #ffc2e2; /* Soft pastel pink background */
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        #start-button:hover {
            transform: scale(1.1);
        }

        /* Main content area, hidden by default */
        #main-content {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding-bottom: 20px;
            position: relative; /* Needed for z-index to work */
            z-index: 10;
        }
        
        /* Photo container for positioning the heart */
        .photo-container {
            position: relative;
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 250px;
            height: 250px;
        }

        /* Birthday person's photo */
        .birthday-photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid #ffc2e2;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            z-index: 2;
        }

        /* Canvas for the binary heart animation */
        #heart-canvas-start, #heart-canvas-main {
            position: absolute;
            top: 0;
            left: 0;
            width: 250px;
            height: 250px;
            z-index: 1;
        }


        /* Name title style */
        .name-title {
            font-size: 2.5rem;
            color: #a06d8a; /* Muted pastel purple color */
            margin-bottom: 20px;
            text-shadow: 0 0 15px #ffc2e2;
        }

        /* Main container for the cake */
        .cake {
            position: relative;
            width: 250px;
            height: 200px;
            margin-top: 10px;
        }

        /* The plate the cake sits on */
        .plate {
            width: 270px;
            height: 110px;
            position: absolute;
            bottom: -10px;
            left: -10px;
            background-color: #e0d3e5; /* Soft pastel purple plate */
            border-radius: 50%;
            box-shadow: 0 2px 0 #d3c5d9, 0 4px 0 #d3c5d9, 0 5px 40px rgba(0, 0, 0, 0.2);
        }

        .cake > * { position: absolute; }

        .layer {
            display: block;
            position: absolute;
            width: 250px;
            height: 100px;
            border-radius: 50%;
            background-color: #fec8d8;
            box-shadow: 0 2px 0px #fdbdd1, 0 4px 0px #fcaec7, 0 6px 0px #fba8c1, 0 8px 0px #faa1bb, 0 10px 0px #f99ab5, 0 12px 0px #f893af, 0 14px 0px #f78caa, 0 16px 0px #f685a4, 0 18px 0px #f57e9e, 0 20px 0px #f47798, 0 22px 0px #f37092, 0 24px 0px #f2698c, 0 26px 0px #f16287, 0 28px 0px #f05b81, 0 30px 0px #ef547b;
        }
        .layer-top { top: 0px; }
        .layer-middle { top: 33px; }
        .layer-bottom { top: 66px; }

        .icing {
            top: 2px; left: 5px;
            background-color: #fff9fa;
            width: 240px; height: 90px;
            border-radius: 50%;
        }
        .icing:before {
            content: ""; position: absolute;
            top: 4px; right: 5px; bottom: 6px; left: 5px;
            background-color: #ffffff;
            box-shadow: 0 0 4px #fff, 0 0 4px #fff, 0 0 4px #fff;
            border-radius: 50%; z-index: 1;
        }

        .drip {
            display: block; width: 50px; height: 60px;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
            background-color: #fff9fa;
        }
        .drip1 { top: 53px; left: 5px; transform: skewY(15deg); height: 48px; width: 40px; }
        .drip2 { top: 69px; left: 181px; transform: skewY(-15deg); }
        .drip3 { top: 54px; left: 90px; width: 80px; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; }

        .candle {
            background-color: #ffb3de;
            width: 16px; height: 50px;
            border-radius: 8px / 4px;
            top: -20px; left: 50%;
            margin-left: -8px; z-index: 10;
        }
        .candle:before {
            content: ""; position: absolute;
            top: 0; left: 0; width: 16px; height: 8px;
            border-radius: 50%; background-color: #ffc2e2;
        }

        .flame {
            position: absolute; background-color: orange;
            width: 15px; height: 35px;
            border-radius: 10px 10px 10px 10px / 25px 25px 10px 10px;
            top: -34px; left: 50%; margin-left: -7.5px;
            z-index: 10;
            box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5);
            transform-origin: 50% 90%;
            animation: flicker 1s ease-in-out alternate infinite;
        }

        @keyframes flicker {
            0% { transform: skewX(5deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.2), 0 0 20px rgba(255, 165, 0, 0.2), 0 0 60px rgba(255, 165, 0, 0.2), 0 0 80px rgba(255, 165, 0, 0.2); }
            25% { transform: skewX(-5deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5); }
            50% { transform: skewX(10deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.3), 0 0 20px rgba(255, 165, 0, 0.3), 0 0 60px rgba(255, 165, 0, 0.3), 0 0 80px rgba(255, 165, 0, 0.3); }
            75% { transform: skewX(-10deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.4), 0 0 20px rgba(255, 165, 0, 0.4), 0 0 60px rgba(255, 165, 0, 0.4), 0 0 80px rgba(255, 165, 0, 0.4); }
            100% { transform: skewX(5deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5); }
        }

        /* Video button style */
        #video-button {
            margin-top: 25px;
            padding: 10px 20px;
            font-size: 1.2rem;
            font-family: 'Kanit', sans-serif;
            color: #5e3c5a;
            background-color: #e0d3e5;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        #video-button:hover {
            transform: scale(1.1);
        }

        /* Video Modal Styles */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 101; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.7);
        }
        .modal-content {
            background-color: #fdf2f6;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 700px;
            border-radius: 10px;
            position: relative;
        }
        .close-button {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 35px;
            font-weight: bold;
        }
        .close-button:hover,
        .close-button:focus {
            color: #5e3c5a;
            text-decoration: none;
            cursor: pointer;
        }

        /* --- โค้ดที่เพิ่มเข้ามาใหม่ --- */

/* จัดตำแหน่ง canvas ของหัวใจให้อยู่ตรงกลางจอ และหลังองค์ประกอบอื่น */
#start-screen > #heart-canvas-start {
  top: 15%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1; /* z-index เดิมจาก #heart-canvas-start, #heart-canvas-main */
}

/* ทำให้รูปภาพ ข้อความ และปุ่ม แสดงอยู่เหนืออนิเมชันหัวใจ */
.photo-container, #start-screen h1, #start-button {
  position: relative;
  z-index: 2;
}

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    
    <canvas id="fireworks-canvas"></canvas>

    <div class="heart-container">
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
    </div>

    <div class="balloon-container">
        <div class="balloon"><img src="assets/img/DSCF1488.JPG"></div>
        <div class="balloon"><img src="assets/img/DSCF1383.JPG"></div>
        <div class="balloon"><img src="assets/img/DSC04881.JPG"></div>
        <div class="balloon"><img src="assets/img/DSC04395.JPG"></div>
        <div class="balloon"><img src="assets/img/DSC04403.JPG"></div>
        <div class="balloon"><img src="assets/img/DSC04161.JPG"></div>
        <div class="balloon"><img src="assets/img/DSCF1430.JPG"></div>
        <div class="balloon"><img src="assets/img/DSCF1462 2.JPG"></div>
        <div class="balloon"><img src="assets/img/DSCF1464.JPG"></div>
        <div class="balloon"><img src="assets/img/DSCF1485 2.JPG"></div>
        <div class="balloon"><img src="assets/img/DSCF1529.JPG"></div>
    </div>

    <div id="start-screen">
        
        <div class="photo-container">
            
            <img src="assets/img/DSC04626.JPG" alt="Birthday Person" class="birthday-photo">
        </div>
        <h1>สุขสันต์วันเกิด!</h1>
        <button id="start-button">คลิกเพื่อดูคำอวยพร</button>
        <canvas id="heart-canvas-start"></canvas>
    </div>

    <div id="main-content">
        <div class="photo-container">
            <canvas id="heart-canvas-main"></canvas>
            <img src="assets/img/DSC04626.JPG" alt="Birthday Person" class="birthday-photo">
        </div>
        <h1 class="name-title">jihexpeddopepop</h1>
        <br>
        <div class="cake">
            <div class="plate"></div>
            <div class="layer layer-bottom"></div>
            <div class="layer layer-middle"></div>
            <div class="layer layer-top"></div>
            <div class="icing"></div>
            <div class="drip drip1"></div>
            <div class="drip drip2"></div>
            <div class="drip drip3"></div>
            <div class="candle">
                <div class="flame"></div>
            </div>
        </div>
        <button id="video-button">ดูวิดีโอพิเศษ</button>
    </div>

    <div id="player" style="display: none;"></div>

    <!-- Video Modal -->
    <div id="video-modal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <!-- The video source has been updated to the relative path you provided -->
        <video id="birthday-video" width="100%" controls>
          <source src="assets/img/IMG_6496.mp4" type="video/mp4">
          เบราว์เซอร์ของคุณไม่รองรับวิดีโอแท็ก
        </video>
      </div>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        let player;
        const video1_id = 'n4iWaZrRAl8';
        const video2_id = '1IoehBQUg5k';

        function onYouTubeIframeAPIReady() {
            // Player will be created on button click
        }

        function startMusic() {
            player = new YT.Player('player', {
                height: '0',
                width: '0',
                videoId: video1_id,
                playerVars: { 'autoplay': 1, 'controls': 0, 'loop': 0, 'playsinline': 1 },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            event.target.playVideo();
        }

        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.ENDED) {
                const currentVideoUrl = event.target.getVideoUrl();
                if (currentVideoUrl.includes(video1_id)) {
                    player.loadVideoById(video2_id);
                }
            }
        }

        document.getElementById('start-button').addEventListener('click', () => {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('main-content').style.display = 'flex';
            startMusic();
        });

        // Video Modal Script
        const modal = document.getElementById("video-modal");
        const videoButton = document.getElementById("video-button");
        const closeButton = document.getElementsByClassName("close-button")[0];
        const birthdayVideo = document.getElementById("birthday-video");

        videoButton.onclick = function() {
            modal.style.display = "block";
            if (player && typeof player.pauseVideo === 'function') {
                player.pauseVideo();
            }
        }

        closeButton.onclick = function() {
            modal.style.display = "none";
            birthdayVideo.pause();
            if (player && typeof player.playVideo === 'function') {
                player.playVideo();
            }
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
                birthdayVideo.pause();
                if (player && typeof player.playVideo === 'function') {
                    player.playVideo();
                }
            }
        }

        // Fireworks Script
        const fireworksCanvas = document.getElementById('fireworks-canvas');
        const fireworksCtx = fireworksCanvas.getContext('2d');
        let fireworks = [];
        let particles = [];

        fireworksCanvas.width = window.innerWidth;
        fireworksCanvas.height = window.innerHeight;

        function random(min, max) {
            return Math.random() * (max - min) + min;
        }

        function Firework(sx, sy, tx, ty) {
            this.x = sx; this.y = sy;
            this.sx = sx; this.sy = sy;
            this.tx = tx; this.ty = ty;
            this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
            this.distanceTraveled = 0;
            this.coordinates = [];
            this.coordinateCount = 3;
            while (this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = Math.atan2(ty - sy, tx - sx);
            this.speed = 2;
            this.acceleration = 1.05;
            this.brightness = random(50, 70);
            this.targetRadius = 1;
        }

        Firework.prototype.update = function(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            if (this.targetRadius < 8) { this.targetRadius += 0.3; } else { this.targetRadius = 1; }
            this.speed *= this.acceleration;
            let vx = Math.cos(this.angle) * this.speed;
            let vy = Math.sin(this.angle) * this.speed;
            this.distanceTraveled = Math.sqrt(Math.pow(this.x - this.sx, 2) + Math.pow(this.y - this.sy, 2));
            if (this.distanceTraveled >= this.distanceToTarget) {
                createParticles(this.tx, this.ty);
                fireworks.splice(index, 1);
            } else {
                this.x += vx;
                this.y += vy;
            }
        };

        Firework.prototype.draw = function() {
            fireworksCtx.beginPath();
            fireworksCtx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            fireworksCtx.lineTo(this.x, this.y);
            fireworksCtx.strokeStyle = 'hsl(' + random(0, 360) + ', 100%, ' + this.brightness + '%)';
            fireworksCtx.stroke();
            fireworksCtx.beginPath();
            fireworksCtx.arc(this.tx, this.ty, this.targetRadius, 0, Math.PI * 2);
            fireworksCtx.stroke();
        };

        function Particle(x, y) {
            this.x = x; this.y = y;
            this.coordinates = [];
            this.coordinateCount = 5;
            while (this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = random(0, Math.PI * 2);
            this.speed = random(1, 10);
            this.friction = 0.95;
            this.gravity = 1;
            this.hue = random(0, 360);
            this.brightness = random(50, 80);
            this.alpha = 1;
            this.decay = random(0.015, 0.03);
        }

        Particle.prototype.update = function(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= this.decay;
            if (this.alpha <= this.decay) { particles.splice(index, 1); }
        };

        Particle.prototype.draw = function() {
            fireworksCtx.beginPath();
            fireworksCtx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            fireworksCtx.lineTo(this.x, this.y);
            fireworksCtx.strokeStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + this.alpha + ')';
            fireworksCtx.stroke();
        };

        function createParticles(x, y) {
            let particleCount = 30;
            while (particleCount--) { particles.push(new Particle(x, y)); }
        }

        function loopFireworks() {
            requestAnimationFrame(loopFireworks);
            fireworksCtx.globalCompositeOperation = 'destination-out';
            fireworksCtx.fillStyle = 'rgba(0, 0, 0, 0.5)';
            fireworksCtx.fillRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
            fireworksCtx.globalCompositeOperation = 'lighter';
            let i = fireworks.length;
            while (i--) { fireworks[i].draw(); fireworks[i].update(i); }
            let j = particles.length;
            while (j--) { particles[j].draw(); particles[j].update(j); }
            if (Math.random() < 0.05) {
                fireworks.push(new Firework(fireworksCanvas.width / 2, fireworksCanvas.height, random(0, fireworksCanvas.width), random(0, fireworksCanvas.height / 2)));
            }
        }
        
        window.addEventListener('resize', () => {
            fireworksCanvas.width = window.innerWidth;
            fireworksCanvas.height = window.innerHeight;
        });
        
        loopFireworks();

        // Binary Heart Animation Script
        const heartCanvases = [document.getElementById('heart-canvas-start'), document.getElementById('heart-canvas-main')];
        heartCanvases.forEach(canvas => {
            if (canvas) {
                const ctx = canvas.getContext('2d');
                canvas.width = 250;
                canvas.height = 250;
                let heartParticles = [];
                const heartColor = '#E31B23'; // A nice red color for the heart

                class HeartParticle {
                    constructor(x, y, color) {
                        this.x = x;
                        this.y = y;
                        this.originX = x;
                        this.originY = y;
                        this.color = color;
                        this.size = 3;
                        this.vx = 0;
                        this.vy = 0;
                        this.life = 0;
                        this.maxLife = Math.random() * 120 + 180; // frames
                        this.char = Math.random() > 0.5 ? '1' : '0';
                    }

                    draw() {
                        ctx.globalAlpha = Math.max(1 - (this.life / this.maxLife), 0);
                        if (this.life > 100) {
                            ctx.font = '12px monospace';
                            ctx.fillStyle = this.color;
                            ctx.fillText(this.char, this.x, this.y);
                        } else {
                            ctx.fillStyle = this.color;
                            ctx.fillRect(this.x, this.y, this.size, this.size);
                        }
                        ctx.globalAlpha = 1;
                    }

                    update() {
                        this.life++;
                        if (this.life > 100) {
                            if (this.vx === 0 && this.vy === 0) {
                                this.vx = (Math.random() - 0.5) * 3;
                                this.vy = (Math.random() - 0.5) * 3;
                            }
                            this.x += this.vx;
                            this.y += this.vy;
                        }
                        if (this.life >= this.maxLife) {
                            this.life = 0;
                            this.x = this.originX;
                            this.y = this.originY;
                            this.vx = 0;
                            this.vy = 0;
                        }
                    }
                }

                function initHeart() {
                    heartParticles = [];
                    const tempCanvas = document.createElement('canvas');
                    const tempCtx = tempCanvas.getContext('2d');
                    tempCanvas.width = canvas.width;
                    tempCanvas.height = canvas.height;
                    
                    // Draw a heart shape
                    tempCtx.fillStyle = heartColor;
                    tempCtx.beginPath();
                    tempCtx.moveTo(125, 80);
                    tempCtx.bezierCurveTo(75, 20, 25, 50, 125, 180);
                    tempCtx.bezierCurveTo(225, 50, 175, 20, 125, 80);
                    tempCtx.closePath();
                    tempCtx.fill();

                    const imageData = tempCtx.getImageData(0, 0, tempCanvas.width, tempCanvas.height);
                    for (let y = 0; y < imageData.height; y += 4) {
                        for (let x = 0; x < imageData.width; x += 4) {
                            if (imageData.data[(y * imageData.width + x) * 4 + 3] > 128) {
                                heartParticles.push(new HeartParticle(x, y, heartColor));
                            }
                        }
                    }
                }

                function animateHeart() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    for (let i = 0; i < heartParticles.length; i++) {
                        heartParticles[i].update();
                        heartParticles[i].draw();
                    }
                    requestAnimationFrame(animateHeart);
                }

                initHeart();
                animateHeart();
            }
        });
    </script>
</body>
</html>
